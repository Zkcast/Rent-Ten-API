<div class="container">


  <div
    *ngIf="filterForm.value.minPrice || filterForm.value.maxPrice || filterForm.value.allowpets || filterForm.value.wifi || selectedCountry || selectedCity || filterForm.value.order">

    <div [ngClass]="darkmode? 'card mb-4 paginadoYfiltros darkmode':'card mb-4 paginadoYfiltros'">
      <div class="card-header d-flex justify-content-between align-item-center">
        <mat-paginator class="mat-app-background paginado" [length]="allHouses?.length" [pageSize]="page_size"
          [pageSizeOptions]="page_size_options" (page)="handlePage($event)" showFirstLastButtons="">
        </mat-paginator>
        &nbsp;&nbsp;&nbsp;&nbsp;

        <button class="buttonFilter">
          <h3 type="button" color="raised" aria-label="Sing Up" (click)="openFilterModal(filters)">
            <mat-icon>filter_list</mat-icon>Filters
          </h3>
        </button>

      </div>
    </div>


    <div class="bodydiv">
      <div class="grid">
        <app-house *ngFor="let house of allHouses$ | async | paginate: page_size:page_number" [house]="house"
          [dbProfile]="dbProfile" class="grid-content"></app-house>
      </div>

    </div>
  </div>

  <div *ngIf="!allHouses?.length && filterForm.value.minPrice || filterForm.value.maxPrice || filterForm.value.allowpets || filterForm.value.wifi || selectedCountry || selectedCity || filterForm.value.order">
    <h3 style="font-size: 3rem;">There is no house with those requirements</h3>
    <button type="button" class="btn btn-outline-dark" (click)="clearFilters()">Clear filters</button>
  </div>

  <div
    *ngIf="!filterForm.value.minPrice && !filterForm.value.maxPrice && !filterForm.value.allowpets && !filterForm.value.wifi && !filterForm.value.country && !selectedCity && !filterForm.value.order">
    <div class="alternative_home">

      <button type="button" color="raised" aria-label="Sing Up" (click)="openFilterModal(filters)"
        class="alternativehome_buttonFilter">
        Filters
        <br/>
        <mat-icon>filter_list</mat-icon> 
      </button>
    </div>

    <app-alternativehome [dbProfile]="dbProfile" ></app-alternativehome>
  </div>


</div>
<footer class="footer">Footer TEST</footer>


<ng-template #filters let-modal>
  <div [ngClass]="darkmode? 'container-modal darkmodeModal':'container-modal'">
    <div class="modal-header d-flex align-items-center">
      <h3 style="margin: 0; font-size: 1.5rem;">Filters</h3>
      <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
      <form [formGroup]="filterForm" (ngSubmit)="handleFilters()">
        <div class="mb-2">
          <ng-container>
            <div style="display: flex;">
              <div>
                <mat-label>Select Country</mat-label>
                <select name="selectedCountry" (change)="handleCountry()" style="max-height: 100%;  margin-top: 0.5%"
                  class="form-select form-select-sm" aria-label="Ejemplo de .form-select-lg" appearance="outline"
                  formControlName="country">
                  <!-- <option *ngFor="let country of backupHouses" value="{{country}}">{{country}}</option> -->
                  <option *ngFor="let country of backupHouses" [ngValue]="country">{{country}}</option>
                </select>
              </div>
              <div>
                <mat-label *ngIf="filterForm.value.country.length">Selected City</mat-label>
                <select *ngIf="filterForm.value.country.length" name="ciudades" style="max-height: 100%;"
                  aria-label="Ejemplo de .form-select-lg" class="form-select form-select-sm" appearance="outline"
                  (change)="handleCity($event)" formControlName="city">
                  <option disabled selected></option>
                  <option *ngFor="let ciudades of city" [ngValue]="ciudades">
                    {{ciudades}}
                  </option>
                </select>
              </div>
            </div>
            <div class="modalmb-2">
              <div class="modal-header d-flex justify-content-between align-item-center">
                Price range
              </div>
              <div class="modal-body">
                <div style="font-size: 1rem; ">
                  <mat-form-field style="max-width: 150px; max-height: 20px;" appearance="outline">
                    <mat-label>Min price</mat-label>
                    <input name="minPrice" type="number" matInput placeholder="USD" formControlName="minPrice">
                    <mat-icon matPrefix>dolar_symbol</mat-icon>
                  </mat-form-field>
                  <mat-form-field style="max-width: 150px;" appearance="outline">
                    <mat-label>Max price</mat-label>
                    <input name="maxPrice" type="number" matInput placeholder="USD" formControlName="maxPrice">
                    <mat-icon matPrefix>dolar_symbol</mat-icon>
                  </mat-form-field>
                  <select aria-placeholder="Order by" (change)="handleOrder()"
                    style="max-height: 20%; max-width: 40%; margin-top: 0.5%" class="form-select form-select-sm"
                    appearance="outline" formControlName="order">
                    <mat-label>Order by</mat-label>
                    <option selected value="">Order by</option>
                    <option value="min">Cheapest first</option>
                    <option value="max">Most expensive</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="modalmb-2">
              <div class="modal-header d-flex justify-content-between align-item-center">
                Services
              </div>
              <div class="modal-body">
                <button title="Allow pets" name="allowpets"
                  style="margin-left: 1%; margin-top: 0.5%; min-width: 35px; min-height: 35px;"
                  (click)="filterForm.get('allowPets')?.setValue(false)" *ngIf="filterForm.value.allowPets === true"
                  type="button" class="btn btn-primary btn-sm"><span class="material-icons">pets</span>
                </button>
                <button title="Allow pets" style="margin-left: 1%; margin-top: 0.5%; min-width: 35px; min-height: 35px;"
                  (click)="filterForm.get('allowPets')?.setValue(true)"
                  *ngIf="filterForm.value.allowPets === undefined || filterForm.value.allowPets === false" type="button"
                  class="btn btn-secondary btn-sm"><span class="material-icons">pets</span>
                </button>
                <button title="With wifi." name="wifi"
                  style="margin-left: 1%; margin-top: 0.5%; min-width: 35px; min-height: 35px;"
                  (click)="filterForm.get('wifi')?.setValue(false)" *ngIf="filterForm.value.wifi === true" type="button"
                  class="btn btn-primary btn-sm"><span class="material-icons">wifi</span>
                </button>
                <button title="With wifi" style="margin-left: 1%; margin-top: 0.5%; min-width: 35px; min-height: 35px;"
                  (click)="filterForm.get('wifi')?.setValue(true)"
                  *ngIf="filterForm.value.wifi === undefined || filterForm.value.wifi === false" type="button"
                  class="btn btn-secondary btn-sm"><span class="material-icons">wifi</span>
                </button>
              </div>
              <div class="modal-footer"></div>
            </div>
          </ng-container>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="clearFilters()">Clear filters</button>
      <button type="button" class="btn btn-outline-dark" (click)="applyFilter(); modal.dismiss('Cross click')">Apply
        filters</button>
    </div>
    {{filterForm.value|json}}
  </div>
</ng-template>